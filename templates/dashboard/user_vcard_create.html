{% extends "base.html" %}
{% load static %}

{% block title %}Crear tarjeta - Mibio{% endblock %}

{# CSS propio de esta p√°gina #}
{% block head %}
<link rel="stylesheet" href="{% static 'dashboard/css/user_vcard_create.css' %}">
{% endblock %}

{% block body %}
<div class="min-h-dvh grid md:grid-cols-[260px_1fr]">
  <!-- SIDEBAR -->
  <aside
    class="bg-slate-900/70 border-r border-slate-800 p-4 md:sticky md:top-0 md:h-dvh overflow-auto no-scrollbar"
  >
    {% include "dashboard/_sidebar_user.html" %}
  </aside>

  <!-- CONTENIDO -->
  <main class="bg-gradient-to-b from-slate-900 to-slate-950">
    <div class="wrap max-w-[1200px] mx-auto px-4 md:px-6 py-4">
     
      {% comment %} {% block head_extra %}
  <link rel="stylesheet" href="{% static 'dashboard/css/user_vcard_create.css' %}">
{% endblock %} {% endcomment %}

      <!-- ====== LIENZO EDITOR + PREVIEW ====== -->
      <div class="shell">
        <!-- Columna izquierda -->
        <div class="left">
          {% comment %} ========= DOCK DE SECCIONES: pesta√±as para navegar entre grupos del editor ========= {% endcomment %}
<div class="formDock">
  {% comment %} Barra de pesta√±as; cada bot√≥n apunta a una secci√≥n del formulario por data-target {% endcomment %}
  <nav class="tabs" id="editorTabs" aria-label="Secciones del editor">
    {% comment %} Bot√≥n de pesta√±a activa por defecto: muestra la secci√≥n #editorForm (Perfil) {% endcomment %}
    <button class="tab is-active" data-target="#editorForm">Perfil</button>

    <button class="tab" data-target="#colorsForm">Dise√±o</button>

    <button class="tab" data-target="#acc-heading">Acerca</button>

    <button class="tab" data-target="#acc-contact">Contacto</button>

    <button class="tab" data-target="#acc-images">Galer√≠a</button>

    <button class="tab" data-target="#acc-social">Redes Sociales</button>

    <button class="tab" data-target="#acc-links">Enlaces</button>
  </nav>
</div>

{% comment %} ========= URL: selecci√≥n del slug p√∫blico de la tarjeta (mibio.mx/<slug>) ========= {% endcomment %}
<div class="card urlCard">
  {% comment %} T√≠tulo + aviso: el slug no es editable despu√©s de guardar {% endcomment %}
  <h3 style="display: flex; align-items: center; gap: 0.5rem">
    URL de tu p√°gina
    <small class="hint" style="font-weight: 500">(Una vez guardado, no se puede cambiar m√°s tarde)</small>
  </h3>

  {% comment %} Grupo visual: prefijo fijo + input del slug en la misma ‚Äúcaja‚Äù {% endcomment %}
  <div class="urlRow">
    {% comment %} Prefijo fijo del dominio visible al usuario {% endcomment %}
    <div class="urlPrefix">mibio.mx/</div>

    {% comment %} Input del slug:
    - minlength/pattern: fuerza formato (min 5, s√≥lo a-z, 0-9 y guiones)
    - value: usa valor del contexto o uno por defecto
    - HTMX: valida disponibilidad del slug en vivo (keyup/changed con debounce) y muestra respuesta en #slugStatus
    {% endcomment %}
    <input
      class="urlInput"
      id="slug"
      name="slug"
      type="text"
      placeholder="tu-enlace"
      minlength="5"
      pattern="[a-z0-9-]{5,}"
      value="{{ slug|default:'rngzvhm1a4wb' }}"
      hx-get="{% url 'vcards:check_slug' %}"
      hx-trigger="keyup changed delay:400ms"
      hx-params="serialize"
      hx-target="#slugStatus"
      hx-swap="innerHTML"
    />
  </div>

  <div id="slugStatus" class="hint" style="margin-top: 0.5rem">
    *m√≠nimo 5 caracteres requeridos
  </div>
</div>

{% comment %} ========= PLANTILLAS: selector tipo carrusel para elegir el layout visual ========= {% endcomment %}
<div class="card templatesWrap">
  <h3 style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
    <span>
      P√°gina Plantilla
      <span class="hint">(Haga clic en la plantilla que desee)</span>
      {% if globals.template_choice %}<span class="pillGlobal" style="margin-left:8px;">Global</span>{% endif %}
    </span>

    <!-- Toggle Global -->
    <label class="switchLabel">
      <span>Usar en todas mis tarjetas</span>
      <span class="switch">
        <input
          type="checkbox"
          {% if globals.template_choice %}checked{% endif %}
          hx-post="{% url 'vcards:set_global' %}"
          hx-vals='{"field":"template_choice","enabled":this.checked}'
          hx-trigger="change">
        <span class="switchTrack"></span>
        <span class="switchDot"></span>
      </span>
    </label>
  </h3>

  {% comment %} Viewport del carrusel: contiene flechas y el riel con las miniaturas {% endcomment %}
  <div class="tplViewport">
    {% comment %} Flecha izquierda {% endcomment %}
    <div class="tplNav left">
      <button type="button" class="tplBtn" data-dir="-1" aria-label="Anterior">&#x276E;</button>
    </div>

    {% comment %} Riel desplazable con las opciones {% endcomment %}
    <div class="tplRail" id="templateRadios" role="listbox" aria-label="Plantillas disponibles">

      {% comment %} ITEM 1: Plantilla ‚Äúburo‚Äù {% endcomment %}
      <label class="tplItem" role="option" aria-selected="true">
        <input
          type="radio"
          name="template"
          value="buro"
          checked
          hx-post="{% url 'vcards:preview' %}"
          hx-trigger="change"
          hx-target="#preview"
          hx-include="#editorForm, #templateRadios input[name='template']:checked">
        <div class="tplThumb {% if globals.template_choice %}is-global{% endif %}">
          <img src="https://cdn0070.qrcodechimp.com/images/digitalCard/dbcv2/digital-business-cards-template-real-estate.webp"
               alt="Plantilla Buro" loading="lazy">
          <span class="tplTick">‚úì</span>
        </div>
        <div class="tplName">Buro</div>
      </label>

      <label class="tplItem" role="option" aria-selected="false">
        <input
          type="radio"
          name="template"
          value="dual"
          hx-post="{% url 'vcards:preview' %}"
          hx-trigger="change"
          hx-target="#preview"
          hx-include="#editorForm, #templateRadios input[name='template']:checked">
        <div class="tplThumb {% if globals.template_choice %}is-global{% endif %}">
          <img src="https://cdn0070.qrcodechimp.com/images/digitalCard/dbcv2/digital-business-cards-template-real-estate.webp"
               alt="Plantilla Dual" loading="lazy">
          <span class="tplTick">‚úì</span>
        </div>
        <div class="tplName">Dual</div>
      </label>

      <label class="tplItem" role="option" aria-selected="false">
        <input
          type="radio"
          name="template"
          value="dual2"
          hx-post="{% url 'vcards:preview' %}"
          hx-trigger="change"
          hx-target="#preview"
          hx-include="#editorForm, #templateRadios input[name='template']:checked">
        <div class="tplThumb {% if globals.template_choice %}is-global{% endif %}">
          <img src="https://cdn0070.qrcodechimp.com/images/digitalCard/dbcv2/digital-business-cards-template-real-estate.webp"
               alt="Plantilla Dual 2" loading="lazy">
          <span class="tplTick">‚úì</span>
        </div>
        <div class="tplName">Dual</div>
      </label>

      <label class="tplItem" role="option" aria-selected="false">
        <input
          type="radio"
          name="template"
          value="dual2"
          hx-post="{% url 'vcards:preview' %}"
          hx-trigger="change"
          hx-target="#preview"
          hx-include="#editorForm, #templateRadios input[name='template']:checked">
        <div class="tplThumb {% if globals.template_choice %}is-global{% endif %}">
          <img src="https://cdn0070.qrcodechimp.com/images/digitalCard/dbcv2/digital-business-cards-template-real-estate.webp"
               alt="Plantilla Dual 2" loading="lazy">
          <span class="tplTick">‚úì</span>
        </div>
        <div class="tplName">Dual</div>
      </label>

      <label class="tplItem" role="option" aria-selected="false">
        <input
          type="radio"
          name="template"
          value="dual2"
          hx-post="{% url 'vcards:preview' %}"
          hx-trigger="change"
          hx-target="#preview"
          hx-include="#editorForm, #templateRadios input[name='template']:checked">
        <div class="tplThumb {% if globals.template_choice %}is-global{% endif %}">
          <img src="https://cdn0070.qrcodechimp.com/images/digitalCard/dbcv2/digital-business-cards-template-real-estate.webp"
               alt="Plantilla Dual 2" loading="lazy">
          <span class="tplTick">‚úì</span>
        </div>
        <div class="tplName">Dual</div>
      </label>


      <label class="tplItem" role="option" aria-selected="false">
        <input
          type="radio"
          name="template"
          value="dual2"
          hx-post="{% url 'vcards:preview' %}"
          hx-trigger="change"
          hx-target="#preview"
          hx-include="#editorForm, #templateRadios input[name='template']:checked">
        <div class="tplThumb {% if globals.template_choice %}is-global{% endif %}">
          <img src="https://cdn0070.qrcodechimp.com/images/digitalCard/dbcv2/digital-business-cards-template-real-estate.webp"
               alt="Plantilla Dual 2" loading="lazy">
          <span class="tplTick">‚úì</span>
        </div>
        <div class="tplName">Dual</div>
      </label>

      <!-- Repite el patr√≥n para los dem√°s √≠tems -->
      <label class="tplItem" role="option" aria-selected="false">
        <input
          type="radio"
          name="template"
          value="dual3"
          hx-post="{% url 'vcards:preview' %}"
          hx-trigger="change"
          hx-target="#preview"
          hx-include="#editorForm, #templateRadios input[name='template']:checked">
        <div class="tplThumb {% if globals.template_choice %}is-global{% endif %}">
          <img src="https://cdn0070.qrcodechimp.com/images/digitalCard/dbcv2/digital-business-cards-template-real-estate.webp"
               alt="Plantilla Dual 3" loading="lazy">
          <span class="tplTick">‚úì</span>
        </div>
        <div class="tplName">Dual</div>
      </label>

      <!-- ... (m√°s items seg√∫n necesites) ... -->

    </div>

    {% comment %} Flecha derecha {% endcomment %}
    <div class="tplNav right">
      <button type="button" class="tplBtn" data-dir="1" aria-label="Siguiente">&#x276F;</button>
    </div>
  </div>
</div>



         {% comment %} ========== [INICIO COMENTARIOS DEL C√ìDIGO | SECCI√ìN: PERFIL] ==========
Este bloque define el acorde√≥n "Perfil" del editor de vCards. 
- Usa HTMX para previsualizar en vivo (#preview) cuando el usuario escribe o cambia campos.
- Contiene sub-bloques para subir Imagen de Perfil (foto), Banner e incluso Video.
- Tambi√©n incluye toggles para marcar algunos activos como "globales" (se aplican a todas las tarjetas del usuario).
- Los sub-formularios de subida (asset-uploader) son formularios separados porque requieren multipart/form-data.
========== [FIN RESUMEN INICIAL] ========== {% endcomment %}

{# ---------- PERFIL (formulario principal que dispara la previsualizaci√≥n) ---------- #}
<form
  id="editorForm"
  class="card accordion profile-acc"
  {# HTMX: al cargar, escribir o cambiar algo, hace POST a 'vcards:preview' para refrescar #preview #}
  hx-post="{% url 'vcards:preview' %}"
  hx-trigger="load, keyup changed delay:250ms, change"
  hx-target="#preview"
  hx-swap="innerHTML"
  {# Incluir: la plantilla seleccionada y todos los inputs/textarea del editor para previsualizar #}
  hx-include="#templateRadios input[name='template']:checked, #editorForm input, #editorForm textarea"
>
  {# Token CSRF requerido en formularios Django #}
  {% csrf_token %}

  {# Campo oculto con el nombre de la plantilla seleccionada (valor por defecto: 'buro') #}
  <input type="hidden" name="template" id="templateField" value="buro">

  {# Cabezal del acorde√≥n (abre/cierra el cuerpo). aria-expanded=true => abierto #}
  <button type="button" class="acc-head" aria-expanded="true">
    <div class="acc-left"><span class="acc-title">Perfil</span></div>
    <span class="acc-icon">‚àí</span>
  </button>

  {# Cuerpo visible del acorde√≥n (display:block para mostrarlo por defecto) #}
  <div class="acc-body" style="display:block">

    {# Fila que agrupa "activos" (foto, banner, video) en columnas #}
    <div class="assets-row">

  {# ===================== FOTO (Imagen de perfil) ===================== #}
  <div class="asset-group">
    {# Tile de vista previa de la foto. Si la foto es "global", agrega clase is-global #}
    <div id="photoTile" class="tile avatar-preview {% if globals.photo %}is-global{% endif %}" aria-label="Foto de perfil">
      {# Si hay foto, mostrar <img>; si no, muestra un placeholder (üñºÔ∏è) #}
      {% if photo %}<img src="{{ photo }}" alt="" class="tile-preview">{% else %}<div class="tile-empty">üñºÔ∏è</div>{% endif %}
    </div>

    {% comment %} {# Sub-formulario exclusivo para subir imagen (usa multipart). 
       HTMX actualiza el tile (#photoTile) con el HTML devuelto (outerHTML reemplaza todo el nodo). #} {% endcomment %}
    <form class="asset-uploader"
          hx-post="/vcards/upload-image/?field=photo"
          hx-encoding="multipart/form-data"
          hx-target="#photoTile" hx-swap="outerHTML">
      {% csrf_token %}
      {# Input de archivo escondido. El bot√≥n "tile" dispara su click v√≠a JS (data-upload-btn) #}
      <input type="file" name="image" accept="image/*" class="hidden-file">
      <div class="tile" data-upload-btn title="Subir foto">‚¨ÜÔ∏é</div>
    </form>

    {# Recomendaci√≥n de tama√±o/aspecto #}
    <div class="hint" style="grid-column:1/-1; text-align:center">(500√ó625 px, 4:5)</div>

    {# Campo oculto con la URL/valor de la foto para incluirlo en la previsualizaci√≥n #}
    <input type="hidden" name="photo" value="{{ photo|default:'' }}">

    {# Toggle para marcar la foto como "global" (se aplicar√° a todas las tarjetas) #}
    <label class="asset-toggle">
      <span class="label">Usar en todas mis tarjetas</span>
      <span class="switch switch--sm">
        <input
          type="checkbox"
          {% if globals.photo %}checked{% endif %}
          {# Enviar a 'vcards:set_global' cambiando el estado del campo 'photo' #}
          hx-post="{% url 'vcards:set_global' %}"
          hx-vals='js:{"field":"photo","enabled":this.checked}'
          hx-trigger="change">
        <span class="switchTrack"></span>
        <span class="switchDot"></span>
      </span>
    </label>
  </div>

  {# ===================== BANNER (Imagen ancha) ===================== #}
  <div class="asset-group">
    {# Vista previa del banner; si es global, muestra is-global #}
    <div id="bannerTile" class="tile banner-preview {% if globals.banner %}is-global{% endif %}" aria-label="Banner">
      {% if banner %}<img src="{{ banner }}" alt="" class="tile-preview">{% else %}<div class="tile-empty">T</div>{% endif %}
    </div>

    {# Sub-formulario para subir banner; reemplaza el tile completo con la respuesta #}
    <form class="asset-uploader"
          hx-post="/vcards/upload-image/?field=banner"
          hx-encoding="multipart/form-data"
          hx-target="#bannerTile" hx-swap="outerHTML">
      {% csrf_token %}
      <input type="file" name="image" accept="image/*" class="hidden-file">
      <div class="tile" data-upload-btn title="Subir banner">‚¨ÜÔ∏é</div>
    </form>

    {# Gu√≠a de tama√±o para banner #}
    <div class="hint" style="grid-column:1/-1; text-align:center">(160√ó80 px, 3:1)</div>

    {# Campo oculto con el valor del banner para la previsualizaci√≥n #}
    <input type="hidden" name="banner" value="{{ banner|default:'' }}">

    {# Toggle para hacer el banner global #}
    <label class="asset-toggle">
      <span class="label">Usar en todas mis tarjetas</span>
      <span class="switch switch--sm">
        <input
          type="checkbox"
          {% if globals.banner %}checked{% endif %}
          hx-post="{% url 'vcards:set_global' %}"
          hx-vals='js:{"field":"banner","enabled":this.checked}'
          hx-trigger="change">
        <span class="switchTrack"></span>
        <span class="switchDot"></span>
      </span>
    </label>
  </div>

  {# ===================== VIDEO (cuadrado) ===================== #}
  <div class="asset-group">
    {# Tile de vista previa de video. Si es global => is-global #}
    <div id="videoTile" class="tile {% if globals.video %}is-global{% endif %}" aria-label="Video">
      {% if video_url %}
        {# Previsualiza el video en loop, sin sonido, y apto para m√≥viles (playsinline) #}
        <video class="tile-preview" src="{{ video_url }}" muted loop playsinline></video>
      {% else %}
        <div class="tile-empty">‚ñ∂Ô∏é</div>
      {% endif %}
    </div>

    {# Subida de video con multipart; reemplaza el tile con la respuesta del servidor #}
    <form class="asset-uploader"
          hx-post="/vcards/upload-video/?field=video"
          hx-encoding="multipart/form-data"
          hx-target="#videoTile" hx-swap="outerHTML">
      {% csrf_token %}
      <input type="file" name="video" accept="video/*" class="hidden-file">
      <div class="tile" data-upload-btn title="Subir video">‚¨ÜÔ∏é</div>
    </form>

    {# Nota sobre el formato/relaci√≥n del video #}
    <div class="hint" style="grid-column:1/-1; text-align:center">Video cuadrado</div>

    {# Campo oculto con la URL del video para previsualizar #}
    <input type="hidden" name="video_url" value="{{ video_url|default:'' }}">

    {# Toggle para marcar el video como global #}
    <label class="asset-toggle">
      <span class="label">Usar en todas mis tarjetas</span>
      <span class="switch switch--sm">
        <input
          type="checkbox"
          {% if globals.video %}checked{% endif %}
          hx-post="{% url 'vcards:set_global' %}"
          hx-vals='js:{"field":"video","enabled":this.checked}'
          hx-trigger="change">
        <span class="switchTrack"></span>
        <span class="switchDot"></span>
      </span>
    </label>
  </div>
</div> {# /assets-row #}


    {# ====================== TikTok: URL + toggle global ====================== #}
    <div class="fieldRow">
      <div class="left">
        <label style="margin:0">URL Video TikTok</label>
        {# Si el campo tiktok es global, muestra pastilla indicativa #}
        {% if globals.tiktok %}
          <span class="pillGlobal">Global</span>
        {% endif %}
      </div>

      {# Switch para marcar la URL de TikTok como global #}
      <label class="switchLabel">
        <span>Usar en todas mis tarjetas</span>
        <span class="switch">
          <input
            type="checkbox"
            {% if globals.tiktok %}checked{% endif %}
            hx-post="{% url 'vcards:set_global' %}"
            {# Nota: aqu√≠ usamos event.target.checked porque el input est√° dentro de label #}
            hx-vals='js:{"field":"tiktok","enabled":event.target.checked}'
            hx-trigger="change"
          >
          <span class="switchTrack"></span>
          <span class="switchDot"></span>
        </span>
      </label>
    </div>

    {# Input para la URL de TikTok; env√≠a cambios a preview con debounce 300ms #}
    <input
      class="input"
      name="tiktok_url"
      placeholder="https://www.tiktok.com/@usuario/video/12345"
      hx-post="{% url 'vcards:preview' %}"
      hx-trigger="keyup changed delay:300ms"
      hx-target="#preview"
      hx-include="#editorForm"
    >

    {# ====================== Nombre + toggle global ====================== #}
    <div class="fieldRow" style="margin-top:10px">
      <div class="left">
        <label style="margin:0">Nombre</label>
        {# Indicador de que el nombre actual proviene de un valor global #}
        {% if globals.name %}<span class="pillGlobal">Global</span>{% endif %}
      </div>

      {# Switch para hacer el nombre global #}
      <label class="switchLabel">
        <span>Usar en todas mis tarjetas</span>
        <span class="switch">
          <input
            type="checkbox"
            {% if globals.name %}checked{% endif %}
            hx-post="{% url 'vcards:set_global' %}"
            hx-vals='js:{"field":"name","enabled":event.target.checked}'
            hx-trigger="change"
          >
          <span class="switchTrack"></span>
          <span class="switchDot"></span>
        </span>
      </label>
    </div>

    {# Campo de texto para el nombre; refleja cambios en la previsualizaci√≥n #}
    <input
      class="input"
      name="full_name"
      placeholder="Nombre"
      hx-post="{% url 'vcards:preview' %}"
      hx-trigger="keyup changed delay:300ms"
      hx-target="#preview"
      hx-include="#editorForm"
    >

    {# ====================== Profesi√≥n/T√≠tulo + toggle global ====================== #}
    <div class="fieldRow" style="margin-top:10px">
      <div class="left">
        <label style="margin:0">Profesi√≥n</label>
        {% if globals.title %}<span class="pillGlobal">Global</span>{% endif %}
      </div>

      {# Switch para usar el t√≠tulo en todas las tarjetas #}
      <label class="switchLabel">
        <span>Usar en todas mis tarjetas</span>
        <span class="switch">
          <input
            type="checkbox"
            {% if globals.title %}checked{% endif %}
            hx-post="{% url 'vcards:set_global' %}"
            hx-vals='js:{"field":"title","enabled":event.target.checked}'
            hx-trigger="change"
          >
          <span class="switchTrack"></span>
          <span class="switchDot"></span>
        </span>
      </label>
    </div>

    {# Campo de texto para la profesi√≥n; actualiza la vista previa con debounce #}
    <input
      class="input"
      name="job_title"
      placeholder="Profesi√≥n"
      hx-post="{% url 'vcards:preview' %}"
      hx-trigger="keyup changed delay:300ms"
      hx-target="#preview"
      hx-include="#editorForm"
    >

  </div> {# /acc-body #}
</form>

{% comment %} ========== [FIN COMENTARIOS DEL C√ìDIGO | SECCI√ìN: PERFIL] ========== {% endcomment %}



          {% comment %}
[SECCI√ìN: DISE√ëO / COLORS FORM]
- Formulario independiente que controla colores/estilos de la vCard.
- Usa HTMX para refrescar #preview al cargar y cuando cambian inputs (con debounce).
- Estructura visual con acorde√≥n: .card .accordion .colors-acc
- Clases relevantes a revisar luego en CSS: .colors-acc, .acc-head, .acc-body, .color-swatches, .swatch, .colors-grid,
  .fieldRow, .switchLabel, .switch, .switchTrack, .switchDot, .pillGlobal, .color-field, .color-picker, .input.hex
{% endcomment %}
<form
  id="colorsForm"
  class="card accordion colors-acc"
  {% comment %} HTMX: env√≠a al endpoint de previsualizaci√≥n para actualizar el panel derecho {% endcomment %}
  hx-post="{% url 'vcards:preview' %}"
  {% comment %} Dispara al cargar, y en cambios/teclado con peque√±o retraso para no saturar {% endcomment %}
  hx-trigger="load, change, keyup changed delay:250ms"
  {% comment %} D√≥nde insertar el HTML devuelto (s√≥lo el preview) {% endcomment %}
  hx-target="#preview"
  hx-swap="innerHTML"
  {% comment %} Incluir la plantilla elegida y TODOS los campos de este form en la petici√≥n {% endcomment %}
  hx-include="#templateRadios input[name='template']:checked, #colorsForm"
>
  {% csrf_token %}
  {% comment %} La plantilla activa (por defecto 'buro') viaja junto con los colores {% endcomment %}
  <input type="hidden" name="template" value="buro" />

  {% comment %} Cabezal del acorde√≥n (abre/cierra). Clases: .acc-head controla el header; .acc-icon muestra s√≠mbolo {% endcomment %}
  <button type="button" class="acc-head" aria-expanded="true">
    <div class="acc-left"><span class="acc-title">Dise√±o</span></div>
    <span class="acc-icon">‚àí</span>
  </button>

  {% comment %} Cuerpo visible del acorde√≥n. inline style para mostrar abierto por defecto {% endcomment %}
  <div class="acc-body" style="display: block">
    {% comment %} (Futuro) ‚ÄúToggle maestro‚Äù podr√≠a hacer global todo el dise√±o ‚Äî ahora s√≥lo es comentario gu√≠a {% endcomment %}

    {% comment %}
    PALETA R√ÅPIDA (color-swatches):
    - .color-swatches: contenedor horizontal/fluido de muestras.
    - .swatch: cada bot√≥n cuadrado/circular con un color predefinido (usa data-color para JS).
    - Al hacer click, t√≠picamente se llenan los inputs de color objetivo (JS).
    {% endcomment %}
    <div class="color-swatches" id="swatchRow" aria-label="Colores r√°pidos">
      <div class="swatch" style="background: #517afa" data-color="#517AFA" title="#517AFA"></div>
      <div class="swatch" style="background: #2b4c9b" data-color="#2B4C9B" title="#2B4C9B"></div>
      <div class="swatch" style="background: #d6285f" data-color="#D6285F" title="#D6285F"></div>
      <div class="swatch" style="background: #ff9f1c" data-color="#FF9F1C" title="#FF9F1C"></div>
      <div class="swatch" style="background: #2995a0" data-color="#2995A0" title="#2995A0"></div>
      <div class="swatch" style="background: #0e3b73" data-color="#0E3B73" title="#0E3B73"></div>
      <div class="swatch" style="background: #5866ff" data-color="#5866FF" title="#5866FF"></div>
    </div>

    {% comment %}
    GRID DE COLORES (colors-grid):
    - Estructura de 2 columnas (o responsive) para agrupar campos de color.
    - Cada bloque:
        .fieldRow  -> t√≠tulo + ‚ÄúGlobal‚Äù + switch para usar en todas las tarjetas
        .color-field -> contiene <input type="color"> y el hex textual
        .is-target -> (s√≥lo en el primero) posible gancho JS/estilo para foco destino
    {% endcomment %}
    <div class="colors-grid" id="colorsGrid">

      {% comment %}
      1) Color del t√≠tulo (theme_primary)
      - ‚ÄúGlobal‚Äù indica que el valor viene del set global del usuario.
      - Switch (.switchLabel, .switch, .switchTrack, .switchDot) env√≠a a set_global con field + enabled.
      - .color-picker: input de selector nativo.
      - .input.hex: campo texto del HEX (sin validaci√≥n aqu√≠).
      {% endcomment %}
      <div>
        <div class="fieldRow" style="margin: 0 0 6px">
          <label style="margin: 0">Color del t√≠tulo</label>
          {% if globals.theme_primary %}<span class="pillGlobal">Global</span>{% endif %}
          <label class="switchLabel">
            <span>Usar en todas mis tarjetas</span>
            <span class="switch">
              <input
                type="checkbox"
                {% if globals.theme_primary %}checked{% endif %}
                hx-post="{% url 'vcards:set_global' %}"
                hx-vals='{"field":"theme_primary","enabled":this.checked}'
                hx-trigger="change"
              />
              <span class="switchTrack"></span>
              <span class="switchDot"></span>
            </span>
          </label>
        </div>

        {% comment %} .is-target sugiere foco/estilo especial desde JS/CSS {% endcomment %}
        <div class="color-field is-target" data-field="theme_primary">
          <input
            class="color-picker"
            type="color"
            name="theme_primary_picker"
            value="{{ theme_primary|default:'#517AFA' }}"
          />
          <input
            class="input hex"
            type="text"
            name="theme_primary"
            value="{{ theme_primary|default:'#517AFA' }}"
            placeholder="#517AFA"
          />
        </div>
      </div>

      {% comment %}
      2) Color Texto (theme_secondary)
      - Mismo patr√≥n: indicador Global + switch -> set_global(theme_secondary)
      - Campo color + campo HEX textual
      {% endcomment %}
      <div>
        <div class="fieldRow" style="margin: 0 0 6px">
          <label style="margin: 0">Color Texto</label>
          {% if globals.theme_secondary %}<span class="pillGlobal">Global</span>{% endif %}
          <label class="switchLabel">
            <span>Usar en todas mis tarjetas</span>
            <span class="switch">
              <input
                type="checkbox"
                {% if globals.theme_secondary %}checked{% endif %}
                hx-post="{% url 'vcards:set_global' %}"
                hx-vals='{"field":"theme_secondary","enabled":this.checked}'
                hx-trigger="change"
              />
              <span class="switchTrack"></span>
              <span class="switchDot"></span>
            </span>
          </label>
        </div>

        <div class="color-field" data-field="theme_secondary">
          <input
            class="color-picker"
            type="color"
            name="theme_secondary_picker"
            value="{{ theme_secondary|default:'#C5FEFF' }}"
          />
          <input
            class="input hex"
            type="text"
            name="theme_secondary"
            value="{{ theme_secondary|default:'#C5FEFF' }}"
            placeholder="#C5FEFF"
          />
        </div>
      </div>

      {% comment %}
      3) Color del Fondo (profile_text_primary)
      - OJO: el nombre ‚Äúprofile_text_primary‚Äù suena a ‚Äútexto‚Äù, pero etiqueta dice ‚ÄúFondo‚Äù.
        Revisaremos coherencia al auditar CSS/nombres.
      {% endcomment %}
      <div>
        <div class="fieldRow" style="margin: 0 0 6px">
          <label style="margin: 0">Color del Fondo</label>
          {% if globals.profile_text_primary %}<span class="pillGlobal">Global</span>{% endif %}
          <label class="switchLabel">
            <span>Usar en todas mis tarjetas</span>
            <span class="switch">
              <input
                type="checkbox"
                {% if globals.profile_text_primary %}checked{% endif %}
                hx-post="{% url 'vcards:set_global' %}"
                hx-vals='{"field":"profile_text_primary","enabled":this.checked}'
                hx-trigger="change"
              />
              <span class="switchTrack"></span>
              <span class="switchDot"></span>
            </span>
          </label>
        </div>

        <div class="color-field" data-field="profile_text_primary">
          <input
            class="color-picker"
            type="color"
            name="profile_text_primary_picker"
            value="{{ profile_text_primary|default:'#061244' }}"
          />
          <input
            class="input hex"
            type="text"
            name="profile_text_primary"
            value="{{ profile_text_primary|default:'#061244' }}"
            placeholder="#061244"
          />
        </div>
      </div>

      {% comment %}
      4) Color de los contenedores (profile_text_secondary)
      - Igual que el anterior; revisaremos si el nombre ‚Äúprofile_text_secondary‚Äù coincide con su uso real en CSS.
      {% endcomment %}
      <div>
        <div class="fieldRow" style="margin: 0 0 6px">
          <label style="margin: 0">Color de los contenedores</label>
          {% if globals.profile_text_secondary %}<span class="pillGlobal">Global</span>{% endif %}
          <label class="switchLabel">
            <span>Usar en todas mis tarjetas</span>
            <span class="switch">
              <input
                type="checkbox"
                {% if globals.profile_text_secondary %}checked{% endif %}
                hx-post="{% url 'vcards:set_global' %}"
                hx-vals='{"field":"profile_text_secondary","enabled":this.checked}'
                hx-trigger="change"
              />
              <span class="switchTrack"></span>
              <span class="switchDot"></span>
            </span>
          </label>
        </div>

        <div class="color-field" data-field="profile_text_secondary">
          <input
            class="color-picker"
            type="color"
            name="profile_text_secondary_picker"
            value="{{ profile_text_secondary|default:'#76839B' }}"
          />
          <input
            class="input hex"
            type="text"
            name="profile_text_secondary"
            value="{{ profile_text_secondary|default:'#76839B' }}"
            placeholder="#76839B"
          />
        </div>
      </div>

    </div> {# /colors-grid #}
  </div> {# /acc-body #}
</form>


          {% comment %}
[SECCI√ìN: ACERCA DE / ABOUT SECTION]
- Este bloque forma parte del acorde√≥n principal del editor.
- Permite que el usuario escriba un t√≠tulo y una descripci√≥n sobre s√≠ mismo.
- Usa HTMX para actualizar la previsualizaci√≥n (#preview) cada vez que cambia texto.
- Cada campo (t√≠tulo y descripci√≥n) puede marcarse como ‚Äúglobal‚Äù para reutilizar en todas las tarjetas.
- Clases CSS relevantes a revisar despu√©s:
  .accordion, .acc-head, .acc-body, .acc-left, .acc-title, .acc-icon,
  .fieldRow, .switchLabel, .switch, .switchTrack, .switchDot, .pillGlobal, .input
{% endcomment %}

<div class="accordion" id="acc-heading">
  {% comment %}
  BOT√ìN CABEZAL DEL ACORDE√ìN:
  - aria-controls vincula al ID del cuerpo (#acc-heading-body)
  - aria-expanded controla si est√° abierto o cerrado
  - .acc-head define el dise√±o del encabezado (flex, colores, etc.)
  - .acc-icon muestra el s√≠mbolo ‚Äú+‚Äù o ‚Äú‚àí‚Äù dependiendo del estado
  {% endcomment %}
  <button
    type="button"
    class="acc-head"
    aria-controls="acc-heading-body"
    aria-expanded="false"
  >
    <div class="acc-left">
      <span class="acc-title">Acerca de</span>
    </div>
    <span class="acc-icon">+</span>
  </button>

  {% comment %}
  CUERPO DEL ACORDE√ìN (.acc-body)
  - Contiene los campos del formulario (t√≠tulo y descripci√≥n)
  - Se despliega o colapsa con el bot√≥n anterior
  {% endcomment %}
  <div class="acc-body" id="acc-heading-body">

    {% comment %}
    ===== CAMPO: T√çTULO =====
    - .fieldRow agrupa la etiqueta + switch global
    - .pillGlobal aparece si el campo tiene valor global en el sistema
    - .switchLabel incluye un interruptor tipo toggle que llama a set_global
    {% endcomment %}
    <div class="fieldRow">
      <div class="left">
        <label style="margin: 0">T√≠tulo</label>
        {% if globals.about_title %}
        <span class="pillGlobal">Global</span>
        {% endif %}
      </div>

      {% comment %}
      Toggle (checkbox) para activar el modo global del campo:
      - Si est√° checked, este valor se aplicar√° en todas las vCards del usuario
      - Usa HTMX (hx-post) para notificar a ‚Äòvcards:set_global‚Äô
      {% endcomment %}
      <label class="switchLabel">
        <span>Usar en todas mis tarjetas</span>
        <span class="switch">
          <input
            type="checkbox"
            {% if globals.about_title %}checked{% endif %}
            hx-post="{% url 'vcards:set_global' %}"
            hx-vals='{"field":"about_title","enabled":this.checked}'
            hx-trigger="change"
          />
          <span class="switchTrack"></span>
          <span class="switchDot"></span>
        </span>
      </label>
    </div>

    {% comment %}
    INPUT DE TEXTO:
    - Campo del t√≠tulo ‚ÄúAcerca de‚Äù.
    - Usa HTMX para enviar cambios y actualizar la vista previa.
    - .input es la clase gen√©rica de estilos (borde, padding, etc.)
    {% endcomment %}
    <input
      class="input"
      name="section_title"
      placeholder="Acerca de"
      hx-post="{% url 'vcards:preview' %}"
      hx-trigger="keyup changed delay:250ms"
      hx-target="#preview"
      hx-include="#editorForm"
    />

    {% comment %}
    ===== CAMPO: DESCRIPCI√ìN =====
    - Mismo patr√≥n: indicador Global + toggle + campo textarea
    - La descripci√≥n tambi√©n puede marcarse global
    {% endcomment %}
    <div class="fieldRow" style="margin-top: 14px">
      <div class="left">
        <label style="margin: 0">Descripci√≥n</label>
        {% if globals.about_desc %}
        <span class="pillGlobal">Global</span>
        {% endif %}
      </div>

      <label class="switchLabel">
        <span>Usar en todas mis tarjetas</span>
        <span class="switch">
          <input
            type="checkbox"
            {% if globals.about_desc %}checked{% endif %}
            hx-post="{% url 'vcards:set_global' %}"
            hx-vals='{"field":"about_desc","enabled":this.checked}'
            hx-trigger="change"
          />
          <span class="switchTrack"></span>
          <span class="switchDot"></span>
        </span>
      </label>
    </div>

    {% comment %}
    TEXTAREA DE DESCRIPCI√ìN:
    - Permite escribir varias l√≠neas (rows=4)
    - HTMX vuelve a hacer POST a preview para actualizar
    - .input reutilizada tambi√©n aqu√≠ (usa mismo estilo que inputs)
    {% endcomment %}
    <textarea
      class="input"
      name="section_desc"
      rows="4"
      placeholder="Descripci√≥n"
      hx-post="{% url 'vcards:preview' %}"
      hx-trigger="keyup changed delay:250ms"
      hx-target="#preview"
      hx-include="#editorForm"
    ></textarea>

  </div> {# /acc-body #}
</div> {# /accordion #}


{% comment %}
[SECCI√ìN: CONTACTOS]
- Este bloque define la secci√≥n del formulario donde el usuario agrega informaci√≥n de contacto (tel√©fonos, correos, direcciones).
- Forma parte del acorde√≥n principal del editor.
- Permite crear varios elementos din√°micos dentro de una lista (.contact-list).
- Cada campo usa HTMX para actualizar el preview en tiempo real.
- Clases CSS que revisaremos m√°s adelante:
  .accordion, .acc-head, .acc-body, .acc-left, .acc-title, .acc-icon,
  .fieldRow, .switchLabel, .switch, .switchTrack, .switchDot,
  .pillGlobal, .input, .contact-list, .contact-item, .contact-grid,
  .badge-del, .add-row, .btn-add, .menu, .menu-list, .menu-item
{% endcomment %}

<div class="accordion" id="acc-contact">
  {% comment %}
  BOT√ìN CABEZAL DEL ACORDE√ìN
  - aria-controls vincula al cuerpo (#acc-contact-body)
  - aria-expanded controla si el acorde√≥n est√° abierto o cerrado
  - .acc-head define la apariencia del encabezado
  - .acc-icon muestra ‚Äú+‚Äù o ‚Äú‚àí‚Äù seg√∫n estado (usualmente controlado por JS)
  {% endcomment %}
  <button
    type="button"
    class="acc-head"
    aria-controls="acc-contact-body"
    aria-expanded="false">
    <div class="acc-left">
      <span class="acc-title">Contactos</span>
    </div>
    <span class="acc-icon">+</span>
  </button>

  {% comment %}
  CUERPO DEL ACORDE√ìN (.acc-body)
  - Contiene los campos del t√≠tulo general de la secci√≥n y la lista de contactos.
  {% endcomment %}
  <div class="acc-body" id="acc-contact-body">

    {% comment %}
    ===== CAMPO: T√çTULO DE LA SECCI√ìN =====
    - ‚ÄúContactos‚Äù es el encabezado visible sobre la lista de items.
    - Puede marcarse como global para aplicarse a todas las vCards del usuario.
    {% endcomment %}
    <div class="fieldRow">
      <div class="left">
        <label style="margin:0">T√≠tulo</label>
        {% if globals.contact_section_title %}
          <span class="pillGlobal">Global</span>
        {% endif %}
      </div>

      {% comment %}
      SWITCH GLOBAL:
      - Permite indicar si este t√≠tulo debe usarse en todas las tarjetas.
      - Env√≠a la acci√≥n a ‚Äòvcards:set_global‚Äô con el campo ‚Äúcontact_section_title‚Äù.
      {% endcomment %}
      <label class="switchLabel">
        <span>Usar en todas mis tarjetas</span>
        <span class="switch">
          <input
            type="checkbox"
            {% if globals.contact_section_title %}checked{% endif %}
            hx-post="{% url 'vcards:set_global' %}"
            hx-vals='js:{"field":"contact_section_title","enabled":this.checked}'
            hx-trigger="change">
          <span class="switchTrack"></span>
          <span class="switchDot"></span>
        </span>
      </label>
    </div>

    {% comment %}
    INPUT DE T√çTULO DE SECCI√ìN
    - Texto editable por el usuario (ej: ‚ÄúCont√°ctame‚Äù o ‚ÄúInformaci√≥n‚Äù)
    - HTMX actualiza la vista previa con cada cambio
    {% endcomment %}
    <input
      class="input"
      name="contact_section_title"
      placeholder="Contactos"
      hx-post="{% url 'vcards:preview' %}"
      hx-trigger="keyup changed delay:250ms"
      hx-target="#preview"
      hx-include="#editorForm"
    />

    {% comment %}
    LISTA DE CONTACTOS (.contact-list)
    - Contiene todos los elementos agregados por el usuario (n√∫mero, email, direcci√≥n, etc.)
    - Cada item (.contact-item) tiene inputs propios y puede eliminarse.
    {% endcomment %}
    <div class="contact-list" id="contactList">

      {% comment %}
      ITEM POR DEFECTO: Tel√©fono
      - data-type="number" sirve para identificar el tipo de contacto.
      - .badge-del muestra un icono üóëÔ∏è para eliminar este bloque.
      - Dentro hay un t√≠tulo, un switch global, y dos inputs (etiqueta y n√∫mero).
      {% endcomment %}
      <div class="contact-item" data-type="number">
        <div class="badge-del" title="Eliminar" data-del>üóëÔ∏è</div>

        <div class="fieldRow" style="margin-top:0">
          <div class="left">
            <div class="contact-title">Tel√©fono</div>
            {% if globals.contact_number %}
              <span class="pillGlobal">Global</span>
            {% endif %}
          </div>

          {% comment %}
          SWITCH GLOBAL DEL ITEM
          - Permite marcar este tipo de contacto (tel√©fono) como global.
          - Envia a set_global(field='contact_number')
          {% endcomment %}
          <label class="switchLabel">
            <span>Usar en todas mis tarjetas</span>
            <span class="switch">
              <input
                type="checkbox"
                {% if globals.contact_number %}checked{% endif %}
                hx-post="{% url 'vcards:set_global' %}"
                hx-vals='js:{"field":"contact_number","enabled":this.checked}'
                hx-trigger="change">
              <span class="switchTrack"></span>
              <span class="switchDot"></span>
            </span>
          </label>
        </div>

        {% comment %}
        GRID DE CAMPOS (.contact-grid)
        - Agrupa dos inputs: ‚ÄúEtiqueta‚Äù y ‚ÄúN√∫mero‚Äù.
        - Cada uno env√≠a cambios con HTMX para refrescar la vista previa.
        - Los arrays [] permiten agregar m√∫ltiples contactos del mismo tipo.
        {% endcomment %}
        <div class="contact-grid">
          <div>
            <label>Etiqueta</label>
            <input
              class="input"
              name="contact_label[]"
              placeholder="Etiqueta"
              hx-post="{% url 'vcards:preview' %}"
              hx-trigger="keyup changed delay:250ms"
              hx-target="#preview"
              hx-include="#editorForm"
            />
          </div>
          <div>
            <label>N√∫mero</label>
            <input
              class="input"
              name="contact_value[]"
              placeholder="+52 55 1234 5678"
              hx-post="{% url 'vcards:preview' %}"
              hx-trigger="keyup changed delay:250ms"
              hx-target="#preview"
              hx-include="#editorForm"
            />
          </div>
        </div>

        {% comment %}
        INPUT OCULTO:
        - Guarda el tipo del contacto (en este caso ‚Äúnumber‚Äù)
        - Permite diferenciar tipos al procesar en el backend.
        {% endcomment %}
        <input type="hidden" name="contact_type[]" value="number">
      </div> {# /contact-item #}
    </div> {# /contact-list #}

    {% comment %}
    BOT√ìN ‚Äú+ AGREGAR‚Äù
    - .add-row contiene un men√∫ que se despliega con el bot√≥n principal.
    - .btn-add abre el men√∫ de opciones (Correo, N√∫mero, Direcci√≥n).
    - .menu-list se muestra/oculta mediante JS.
    - Cada .menu-item crea un nuevo contacto del tipo correspondiente.
    {% endcomment %}
    <div class="add-row" style="margin-top:10px">
      <div class="menu" id="contactMenu">
        <button type="button" class="btn-add" id="contactMenuBtn">+ Agregar</button>
        <div class="menu-list" id="contactMenuList" hidden>
          <button type="button" class="menu-item" data-new="email">Correo electr√≥nico</button>
          <button type="button" class="menu-item" data-new="number">N√∫mero</button>
          <button type="button" class="menu-item" data-new="address">Direcci√≥n</button>
        </div>
      </div>
    </div>
  </div> {# /acc-body #}
</div> {# /accordion #}



       {% comment %}
[SECCI√ìN: GALER√çA / IM√ÅGENES]
- Este acorde√≥n permite al usuario configurar la secci√≥n de galer√≠a de su tarjeta digital.
- Se puede elegir el tipo de vista (lista o cuadr√≠cula) y subir im√°genes.
- Cada acci√≥n (toggle, cambio, subida de imagen) actualiza la vista previa en tiempo real con HTMX.
- Clases CSS relevantes a revisar despu√©s:
  .accordion, .acc-head, .acc-body, .acc-left, .acc-title, .acc-icon,
  .fieldRow, .switchLabel, .switch, .switchTrack, .switchDot,
  .pillGlobal, .hint, .view-types, .vt, .mock, .name,
  .image-list, .image-add
{% endcomment %}

<div class="accordion" id="acc-images">
  {% comment %}
  CABEZAL DEL ACORDE√ìN:
  - Controla la expansi√≥n del cuerpo (#acc-images-body)
  - .acc-head define el estilo visual del encabezado.
  - .acc-icon cambia de "+" a "‚àí" cuando se abre (mediante CSS o JS).
  {% endcomment %}
  <button
    type="button"
    class="acc-head"
    aria-controls="acc-images-body"
    aria-expanded="false"
  >
    <div class="acc-left"><span class="acc-title">Galer√≠a</span></div>
    <span class="acc-icon">+</span>
  </button>

  {% comment %}
  CUERPO DEL ACORDE√ìN (.acc-body)
  - Contiene todos los controles para personalizar la galer√≠a (vista y fotos).
  {% endcomment %}
  <div class="acc-body" id="acc-images-body">

    {% comment %}
    ===== SECCI√ìN: TIPO DE VISTA =====
    - Permite seleccionar c√≥mo se mostrar√° la galer√≠a (lista o cuadr√≠cula).
    - El campo puede marcarse como global.
    {% endcomment %}
    <div class="fieldRow">
      <div class="left">
        <label style="margin: 0;">Tipo de vista</label>
        {% if globals.gallery_view %}
          <span class="pillGlobal">Global</span>
        {% endif %}
      </div>

      {% comment %}
      SWITCH GLOBAL:
      - Activa el uso global del tipo de vista.
      - Env√≠a a 'vcards:set_global' con el campo ‚Äúgallery_view‚Äù.
      {% endcomment %}
      <label class="switchLabel">
        <span>Usar en todas mis tarjetas</span>
        <span class="switch">
          <input
            type="checkbox"
            {% if globals.gallery_view %}checked{% endif %}
            hx-post="{% url 'vcards:set_global' %}"
            hx-vals='js:{"field":"gallery_view","enabled":event.target.checked}'
            hx-trigger="change"
          >
          <span class="switchTrack"></span>
          <span class="switchDot"></span>
        </span>
      </label>
    </div>

    {% comment %}
    OPCIONES DE VISTA (.view-types)
    - Grupo de radios que define el layout de las im√°genes.
    - Cada .vt representa una opci√≥n con un mock visual y un nombre.
    - "checked" en ‚Äúlist‚Äù indica vista predeterminada.
    {% endcomment %}
    <div class="view-types" id="viewTypes">
      <div class="vt">
        <input
          type="radio"
          id="vt-list"
          name="images_view"
          value="list"
          checked
        />
        <label for="vt-list">
          <div class="mock">Lista</div>
          <span class="name">Lista</span>
        </label>
      </div>

      <div class="vt">
        <input
          type="radio"
          id="vt-grid1"
          name="images_view"
          value="grid1"
        />
        <label for="vt-grid1">
          <div class="mock">Cuadr√≠cula 1</div>
          <span class="name">Grid 1</span>
        </label>
      </div>

      <div class="vt">
        <input
          type="radio"
          id="vt-grid2"
          name="images_view"
          value="grid2"
        />
        <label for="vt-grid2">
          <div class="mock">Cuadr√≠cula 2</div>
          <span class="name">Grid 2</span>
        </label>
      </div>
    </div>

    {% comment %}
    ===== SECCI√ìN: FOTOS =====
    - Aqu√≠ el usuario puede subir im√°genes para su galer√≠a.
    - Tambi√©n tiene la opci√≥n de marcar las im√°genes como globales.
    {% endcomment %}
    <div class="fieldRow" style="margin-top: 20px;">
      <div class="left">
        <label style="margin: 0;">Fotos <span class="hint">(600√ó600 px, 1:1 o 4:5)</span></label>
        {% if globals.gallery_images %}
          <span class="pillGlobal">Global</span>
        {% endif %}
      </div>

      {% comment %}
      SWITCH GLOBAL:
      - Marca las im√°genes de la galer√≠a como globales.
      - Usa HTMX para enviar el estado al servidor.
      {% endcomment %}
      <label class="switchLabel">
        <span>Usar en todas mis tarjetas</span>
        <span class="switch">
          <input
            type="checkbox"
            {% if globals.gallery_images %}checked{% endif %}
            hx-post="{% url 'vcards:set_global' %}"
            hx-vals='js:{"field":"gallery_images","enabled":event.target.checked}'
            hx-trigger="change"
          >
          <span class="switchTrack"></span>
          <span class="switchDot"></span>
        </span>
      </label>
    </div>

    {% comment %}
    LISTA DE IM√ÅGENES (.image-list)
    - Contiene las miniaturas o placeholders de im√°genes subidas.
    - Al subir una nueva imagen, se a√±ade din√°micamente dentro de este contenedor.
    {% endcomment %}
    <div class="image-list" id="imageList">
      {% comment %}
      FORMULARIO DE SUBIDA DE IM√ÅGENES:
      - hx-post: env√≠a el archivo a "/vcards/upload-image/"
      - hx-encoding="multipart/form-data": permite subir archivos binarios.
      - hx-swap="beforeend": agrega la nueva imagen al final de la lista.
      - hx-on="htmx:afterRequest": ejecuta un script JS despu√©s de subir una imagen,
        recolecta los datos del formulario principal y actualiza la vista previa.
      {% endcomment %}
      <form
        id="imageUploadForm"
        hx-post="/vcards/upload-image/"
        hx-encoding="multipart/form-data"
        hx-target="#imageList"
        hx-swap="beforeend"
        hx-on="htmx:afterRequest:
          const f=document.querySelector('#editorForm');
          const fd=new FormData(f);
          document.querySelectorAll('#imageList input[name=&quot;images[]&quot;]').forEach(i=>fd.append('images[]', i.value));
          const vr=document.querySelector('input[name=&quot;images_view&quot;]:checked'); if(vr) fd.set('images_view', vr.value);
          const bgv=document.getElementById('imagesBgValue'); if(bgv) fd.set('images_card_bg', bgv.value);
          htmx.ajax('POST','/vcards/preview/',{target:'#preview',values:fd});"
        style="display: inline-block"
      >
        {% csrf_token %}
        {% comment %}
        INPUT FILE:
        - Oculto para que se active al presionar el bot√≥n.
        - Acepta √∫nicamente archivos de imagen.
        {% endcomment %}
        <input
          type="file"
          name="image"
          id="imageFile"
          accept="image/*"
          style="display: none"
        />

        {% comment %}
        BOT√ìN PARA SUBIR IM√ÅGENES (.image-add)
        - Al hacer clic, simula un click sobre el input file oculto.
        - √çcono ‚Äú‚¨ÜÔ∏é‚Äù indica subida.
        {% endcomment %}
        <button
          type="button"
          class="image-add"
          onclick="document.getElementById('imageFile').click();"
          title="Subir imagen"
        >
          ‚¨ÜÔ∏é
        </button>
      </form>
    </div> {# /image-list #}
  </div> {# /acc-body #}
</div> {# /accordion #}



<!-- REDES SOCIALES -->
<div class="accordion" id="acc-social">
  <button
    type="button"
    class="acc-head"
    aria-controls="acc-social-body"
    aria-expanded="false">
    <div class="acc-left">
      <span class="acc-title">Redes sociales</span>
    </div>
    <span class="acc-icon">+</span>
  </button>

  <div class="acc-body" id="acc-social-body">

    <!-- T√≠tulo + toggle global -->
    <div class="fieldRow">
      <label style="margin:0">T√≠tulo</label>
      <label class="switchLabel">
        <span>Usar en todas mis tarjetas</span>
        <span class="switch">
          <input
            type="checkbox"
            {% if globals.social_section_title %}checked{% endif %}
            hx-post="{% url 'vcards:set_global' %}"
            hx-vals='{"field":"social_section_title","enabled":this.checked}'
            hx-trigger="change">
          <span class="switchTrack"></span>
          <span class="switchDot"></span>
        </span>
      </label>
    </div>

    <input
      class="input"
      name="social_section_title"
      placeholder="Links de redes sociales"
      hx-post="{% url 'vcards:preview' %}"
      hx-trigger="keyup changed delay:250ms"
      hx-target="#preview"
      hx-include="#editorForm">

    <!-- LISTA DE ITEMS -->
    <div class="social-list" id="socialList">

      {% comment %} ITEM inicial (visible) {% endcomment %}
      <div class="social-item" data-id="social_default">
        <div class="itemHead">
          <div class="left">
            <div class="title">Red social</div>
            {% if globals.social_items and globals.social_items.social_default %}
              <span class="pillGlobal">Global</span>
            {% endif %}
          </div>

          <div class="actions">
            <label class="switchLabel">
              <span>Usar en todas mis tarjetas</span>
              <span class="switch">
                <input
                  type="checkbox"
                  {% if globals.social_items and globals.social_items.social_default %}checked{% endif %}
                  hx-post="{% url 'vcards:set_global' %}"
                  hx-vals='js:(function(el){
                    return {
                      field: "social_item",
                      id: el.closest(".social-item")?.dataset.id || "",
                      enabled: el.checked
                    };
                  })(this)'
                  hx-trigger="change">
                <span class="switchTrack"></span>
                <span class="switchDot"></span>
              </span>
            </label>

            <button type="button" class="badge-del badge-del--inline" title="Eliminar">üóëÔ∏è</button>
          </div>
        </div>

        <div class="social-grid">
          <div class="select-wrap">
            <select
              class="select"
              name="social_network[]"
              hx-post="{% url 'vcards:preview' %}"
              hx-trigger="change"
              hx-target="#preview"
              hx-include="#editorForm">
              <option>Facebook</option>
              <option>Instagram</option>
              <option>LinkedIn</option>
              <option value="X">X (Twitter)</option>
              <option>TikTok</option>
              <option>YouTube</option>
              <option>WhatsApp</option>
              <option>Telegram</option>
              <option>Snapchat</option>
              <option>Pinterest</option>
              <option>Reddit</option>
              <option>GitHub</option>
              <option>Twitch</option>
              <option>Discord</option>
              <option>Behance</option>
              <option>Dribbble</option>
              <option>Medium</option>
              <option>Threads</option>
              <option>Bluesky</option>
              <option>Personalizado</option>
            </select>
          </div>

          <input
            class="input"
            name="social_url[]"
            placeholder="URL"
            hx-post="{% url 'vcards:preview' %}"
            hx-trigger="keyup changed delay:300ms"
            hx-target="#preview"
            hx-include="#editorForm">
        </div>

        <label style="margin-top:12px">T√≠tulo</label>
        <div class="social-grid" style="grid-template-columns:1fr 1fr">
          <input
            class="input"
            name="social_label[]"
            placeholder="Facebook"
            hx-post="{% url 'vcards:preview' %}"
            hx-trigger="keyup changed delay:300ms"
            hx-target="#preview"
            hx-include="#editorForm">

          <input
            class="input"
            name="social_desc[]"
            placeholder="S√≠guenos en Facebook"
            hx-post="{% url 'vcards:preview' %}"
            hx-trigger="keyup changed delay:300ms"
            hx-target="#preview"
            hx-include="#editorForm">
        </div>
      </div>
      <!-- /social-item -->

    </div> <!-- /#socialList -->

    <div class="add-row" style="margin-top: 12px">
      <button type="button" class="btn-add" id="addSocialBtn">+ Agregar link</button>
    </div>

    {% comment %} TEMPLATE para nuevos items de redes {% endcomment %}
    <template id="socialItemTemplate">
      <div class="social-item" data-id="">
        <div class="itemHead">
          <div class="left">
            <div class="title">Red social</div>
          </div>

          <div class="actions">
            <label class="switchLabel">
              <span>Usar en todas mis tarjetas</span>
              <span class="switch">
                <input
                  type="checkbox"
                  hx-post="{% url 'vcards:set_global' %}"
                  hx-vals='js:(function(el){
                    return {
                      field: "social_item",
                      id: el.closest(".social-item")?.dataset.id || "",
                      enabled: el.checked
                    };
                  })(this)'
                  hx-trigger="change">
                <span class="switchTrack"></span>
                <span class="switchDot"></span>
              </span>
            </label>

            <button type="button" class="badge-del badge-del--inline" title="Eliminar">üóëÔ∏è</button>
          </div>
        </div>

        <div class="social-grid">
          <div class="select-wrap">
            <select
              class="select"
              name="social_network[]"
              hx-post="{% url 'vcards:preview' %}"
              hx-trigger="change"
              hx-target="#preview"
              hx-include="#editorForm">
              <option>Facebook</option>
              <option>Instagram</option>
              <option>LinkedIn</option>
              <option value="X">X (Twitter)</option>
              <option>TikTok</option>
              <option>YouTube</option>
              <option>WhatsApp</option>
              <option>Telegram</option>
              <option>Snapchat</option>
              <option>Pinterest</option>
              <option>Reddit</option>
              <option>GitHub</option>
              <option>Twitch</option>
              <option>Discord</option>
              <option>Behance</option>
              <option>Dribbble</option>
              <option>Medium</option>
              <option>Threads</option>
              <option>Bluesky</option>
              <option>Personalizado</option>
            </select>
          </div>

          <input
            class="input"
            name="social_url[]"
            placeholder="URL"
            hx-post="{% url 'vcards:preview' %}"
            hx-trigger="keyup changed delay:300ms"
            hx-target="#preview"
            hx-include="#editorForm">
        </div>

        <label style="margin-top:12px">T√≠tulo</label>
        <div class="social-grid" style="grid-template-columns:1fr 1fr">
          <input
            class="input"
            name="social_label[]"
            placeholder="T√≠tulo"
            hx-post="{% url 'vcards:preview' %}"
            hx-trigger="keyup changed delay:300ms"
            hx-target="#preview"
            hx-include="#editorForm">

          <input
            class="input"
            name="social_desc[]"
            placeholder="Descripci√≥n"
            hx-post="{% url 'vcards:preview' %}"
            hx-trigger="keyup changed delay:300ms"
            hx-target="#preview"
            hx-include="#editorForm">
        </div>
      </div>
    </template>

  </div>
</div>

        



{% comment %}
[SECCI√ìN: ENLACES ‚Äî versi√≥n con men√∫ "+ Agregar" y template clonable]
- Cambios clave:
  1) Se mantiene el header de la secci√≥n con T√≠tulo/Descripci√≥n + toggles globales.
  2) Cada item (.link-item) usa header "itemHead" con el toggle a la derecha junto al bot√≥n eliminar.
  3) Se agrega el MEN√ö "+ Agregar enlace" (con opciones) y un <template> para clonar nuevos items.
  4) Se incluye <script> para abrir/cerrar men√∫, crear/eliminar items y refrescar el preview v√≠a HTMX.
{% endcomment %}

<div class="accordion" id="acc-links">
  {% comment %} CABEZAL DEL ACORDE√ìN {% endcomment %}
  <button
    type="button"
    class="acc-head"
    aria-controls="acc-links-body"
    aria-expanded="false">
    <div class="acc-left"><span class="acc-title">Enlaces</span></div>
    <span class="acc-icon">+</span>
  </button>

  <div class="acc-body" id="acc-links-body">

    {% comment %} ===== TARJETA CABECERA: T√çTULO + DESCRIPCI√ìN (con toggles globales) ===== {% endcomment %}
    <div class="links-card">

      {% comment %} T√≠tulo de secci√≥n + toggle global {% endcomment %}
      <div class="fieldRow" style="margin-bottom:8px">
        <div class="left">
          <label style="margin:0">T√≠tulo</label>
          {% if globals.links_section_title %}<span class="pillGlobal">Global</span>{% endif %}
        </div>
        <label class="switchLabel">
          <span>Usar en todas mis tarjetas</span>
          <span class="switch">
            <input
              type="checkbox"
              {% if globals.links_section_title %}checked{% endif %}
              hx-post="{% url 'vcards:set_global' %}"
              hx-vals='{"field":"links_section_title","enabled":this.checked}'
              hx-trigger="change" />
            <span class="switchTrack"></span>
            <span class="switchDot"></span>
          </span>
        </label>
      </div>

      <input
        class="input"
        name="links_section_title"
        placeholder="Enlaces web"
        hx-post="{% url 'vcards:preview' %}"
        hx-trigger="keyup changed delay:300ms"
        hx-target="#preview"
        hx-include="#editorForm" />

      {% comment %} Descripci√≥n de secci√≥n + toggle global {% endcomment %}
      <div class="fieldRow" style="margin-top:10px; margin-bottom:8px">
        <div class="left">
          <label style="margin:0">Descripci√≥n</label>
          {% if globals.links_section_desc %}<span class="pillGlobal">Global</span>{% endif %}
        </div>
        <label class="switchLabel">
          <span>Usar en todas mis tarjetas</span>
          <span class="switch">
            <input
              type="checkbox"
              {% if globals.links_section_desc %}checked{% endif %}
              hx-post="{% url 'vcards:set_global' %}"
              hx-vals='{"field":"links_section_desc","enabled":this.checked}'
              hx-trigger="change" />
            <span class="switchTrack"></span>
            <span class="switchDot"></span>
          </span>
        </label>
      </div>

      <textarea
        class="input"
        name="links_section_desc"
        rows="4"
        placeholder="Descripci√≥n"
        hx-post="{% url 'vcards:preview' %}"
        hx-trigger="keyup changed delay:300ms"
        hx-target="#preview"
        hx-include="#editorForm"></textarea>
    </div> {# /links-card #}

    {% comment %}
    ===== LISTA DE ENLACES =====
    - Arranca con un item por defecto.
    - Nuevos items se insertan aqu√≠ por JS.
    {% endcomment %}
    <div class="links-list" id="linksList">

      {% comment %} ===== ITEM POR DEFECTO (con toggle + eliminar en header) ===== {% endcomment %}
      <div class="link-item" data-id="default-link">
        <div class="itemHead">
          <div class="left">
            <div class="title">Enlace</div>
            {% if globals.link_url %}<span class="pillGlobal">Global</span>{% endif %}
          </div>
          <div class="actions">
            <label class="switchLabel">
              <span>Usar en todas mis tarjetas</span>
              <span class="switch">
                <input
                  type="checkbox"
                  {% if globals.link_url %}checked{% endif %}
                  hx-post="{% url 'vcards:set_global' %}"
                  hx-vals='{"field":"link_url","enabled":this.checked}'
                  hx-trigger="change" />
                <span class="switchTrack"></span>
                <span class="switchDot"></span>
              </span>
            </label>
            <button type="button" class="link-del link-del--inline" title="Eliminar">üóëÔ∏è</button>
          </div>
        </div>

        <label>URL</label>
        <input
          class="input"
          name="link_url[]"
          placeholder="https://www.mycoolbrand.com"
          hx-post="{% url 'vcards:preview' %}"
          hx-trigger="keyup changed delay:300ms"
          hx-target="#preview"
          hx-include="#editorForm" />

        <div class="row" style="margin-top:10px">
          <div>
            <label>T√≠tulo</label>
            <input
              class="input"
              name="link_title[]"
              placeholder="T√≠tulo"
              hx-post="{% url 'vcards:preview' %}"
              hx-trigger="keyup changed delay:300ms"
              hx-target="#preview"
              hx-include="#editorForm" />
          </div>
          <div>
            <label>Subt√≠tulo</label>
            <input
              class="input"
              name="link_subtitle[]"
              placeholder="Subt√≠tulo"
              hx-post="{% url 'vcards:preview' %}"
              hx-trigger="keyup changed delay:300ms"
              hx-target="#preview"
              hx-include="#editorForm" />
          </div>
        </div>

        {% comment %} Tipo del enlace (√∫til para renderizado posterior) {% endcomment %}
        <input type="hidden" name="link_type[]" value="web" />
      </div> {# /.link-item #}

    </div> {# /links-list #}

    {% comment %}
    ===== MEN√ö +AGREGAR ENLACE =====
    - Bot√≥n visible.
    - Men√∫ con opciones (web/whatsapp/youtube).
    - Al elegir una opci√≥n se clona el template y se inserta un nuevo .link-item.
    {% endcomment %}
    <div class="add-row" style="margin-top:14px">
      <div style="margin-top:14px">
  <button type="button" class="add-link-btn" id="addLinkBtn">+ Agregar enlace</button>
</div>

    </div>

    {% comment %} TEMPLATE que clona JS para nuevos items {% endcomment %}
    <template id="linkItemTemplate">
      <div class="link-item" data-id="">
        <div class="itemHead">
          <div class="left">
            <div class="title">Enlace</div>
            {% if globals.link_url %}<span class="pillGlobal">Global</span>{% endif %}
          </div>
          <div class="actions">
            <label class="switchLabel">
              <span>Usar en todas mis tarjetas</span>
              <span class="switch">
                <input
                  type="checkbox"
                  {% if globals.link_url %}checked{% endif %}
                  hx-post="{% url 'vcards:set_global' %}"
                  hx-vals='{"field":"link_url","enabled":this.checked}'
                  hx-trigger="change" />
                <span class="switchTrack"></span>
                <span class="switchDot"></span>
              </span>
            </label>
            <button type="button" class="link-del link-del--inline" title="Eliminar">üóëÔ∏è</button>
          </div>
        </div>

        <label>URL</label>
        <input
          class="input"
          name="link_url[]"
          placeholder="https://www.mycoolbrand.com"
          hx-post="{% url 'vcards:preview' %}"
          hx-trigger="keyup changed delay:300ms"
          hx-target="#preview"
          hx-include="#editorForm" />

        <div class="row" style="margin-top:10px">
          <div>
            <label>T√≠tulo</label>
            <input
              class="input"
              name="link_title[]"
              placeholder="T√≠tulo"
              hx-post="{% url 'vcards:preview' %}"
              hx-trigger="keyup changed delay:300ms"
              hx-target="#preview"
              hx-include="#editorForm" />
          </div>
          <div>
            <label>Subt√≠tulo</label>
            <input
              class="input"
              name="link_subtitle[]"
              placeholder="Subt√≠tulo"
              hx-post="{% url 'vcards:preview' %}"
              hx-trigger="keyup changed delay:300ms"
              hx-target="#preview"
              hx-include="#editorForm" />
          </div>
        </div>

        <input type="hidden" name="link_type[]" value="web" />
      </div>
    </template>

  </div> {# /acc-links-body #}
</div> {# /acc-links #}


        </div>
        <!-- /left -->

        <!-- Columna derecha: PREVIEW -->
        <div class="right">
          <!-- Barra de acciones (sticky) -->
          <div class="previewDock">
            <div class="btnGroup">
              {% comment %}
              <button
                type="button"
                class="btnIcon"
                title="Copiar enlace"
                data-copy="https://linko.page/rngzvhm1a4wb"
              >
                {% endcomment %}
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  aria-hidden="true"
                >
                  <path
                    d="M9 9h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2Z"
                    stroke="currentColor"
                    stroke-width="1.6"
                  />
                  <path
                    d="M7 15H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h7a2 2 0 0 1 2 2v1"
                    stroke="currentColor"
                    stroke-width="1.6"
                  />
                </svg>
              </button>
              {% comment %}
              <a
                class="btnIcon"
                title="Abrir enlace"
                href="https://linko.page/rngzvhm1a4wb"
                target="_blank"
                rel="noopener"
              >
                {% endcomment %}
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  aria-hidden="true"
                >
                  <path
                    d="M14 5h5v5"
                    stroke="currentColor"
                    stroke-width="1.6"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M10 14 19 5"
                    stroke="currentColor"
                    stroke-width="1.6"
                    stroke-linecap="round"
                  />
                  <path
                    d="M19 14v5H5V5h5"
                    stroke="currentColor"
                    stroke-width="1.6"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </a>
              <button type="button" class="btnIcon" title="Vista previa">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M2 12s4-7 10-7 10 7 10 7-4 7-10 7S2 12 2 12Z"
                    stroke="currentColor"
                    stroke-width="1.6"
                  />
                  <circle
                    cx="12"
                    cy="12"
                    r="3.2"
                    stroke="currentColor"
                    stroke-width="1.6"
                  />
                </svg>
              </button>
              <button type="button" class="btnIcon" title="C√≥digo QR">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                  <path
                    d="M3 3h6v6H3V3Zm12 0h6v6h-6V3ZM3 15h6v6H3v-6Z"
                    stroke="currentColor"
                    stroke-width="1.6"
                  />
                  <path
                    d="M15 15h2m2 0h2m-6 2h2m0 2h2m-6-6h2"
                    stroke="currentColor"
                    stroke-width="1.6"
                    stroke-linecap="round"
                  />
                </svg>
              </button>
            </div>
            <button class="btnPrimary" id="saveBtnRight">Guardar</button>
          </div>

          <!-- Tel√©fono (sticky debajo de la barra) -->
          <div class="phoneWrap">
            <div class="phone">
              <div class="screen" id="preview">Cargando vista previa‚Ä¶</div>
            </div>
          </div>
        </div>
      </div>
      <!-- /shell -->
    </div>
    <!-- /wrap -->
  </main>
</div>


<template id="tpl-contact-email">
  <div class="contact-item" data-type="email">
    <div class="badge-del" title="Eliminar" data-del>üóëÔ∏è</div>

    <div class="fieldRow" style="margin-top:0">
      <div class="left">
        <div class="contact-title">Correo</div>
        {% if globals.contact_email %}<span class="pillGlobal">Global</span>{% endif %}
      </div>
      <label class="switchLabel">
        <span>Usar en todas mis tarjetas</span>
        <span class="switch">
          <input
            type="checkbox"
            {% if globals.contact_email %}checked{% endif %}
            hx-post="{% url 'vcards:set_global' %}"
            hx-vals='js:{"field":"contact_email","enabled":this.checked}'
            hx-trigger="change">
          <span class="switchTrack"></span>
          <span class="switchDot"></span>
        </span>
      </label>
    </div>

    <div class="contact-grid">
      <div>
        <label>Etiqueta</label>
        <input
          class="input"
          name="contact_label[]"
          placeholder="Trabajo / Personal"
          hx-post="{% url 'vcards:preview' %}"
          hx-trigger="keyup changed delay:250ms"
          hx-target="#preview"
          hx-include="#editorForm"
        />
      </div>
      <div>
        <label>Correo</label>
        <input
          class="input"
          name="contact_value[]"
          placeholder="nombre@empresa.com"
          hx-post="{% url 'vcards:preview' %}"
          hx-trigger="keyup changed delay:250ms"
          hx-target="#preview"
          hx-include="#editorForm"
        />
      </div>
    </div>
    <input type="hidden" name="contact_type[]" value="email">
  </div>
</template>

<template id="tpl-contact-number">
  <div class="contact-item" data-type="number">
    <div class="badge-del" title="Eliminar" data-del>üóëÔ∏è</div>

    <div class="fieldRow" style="margin-top:0">
      <div class="left">
        <div class="contact-title">Tel√©fono</div>
        {% if globals.contact_number %}<span class="pillGlobal">Global</span>{% endif %}
      </div>
      <label class="switchLabel">
        <span>Usar en todas mis tarjetas</span>
        <span class="switch">
          <input
            type="checkbox"
            {% if globals.contact_number %}checked{% endif %}
            hx-post="{% url 'vcards:set_global' %}"
            hx-vals='js:{"field":"contact_number","enabled":this.checked}'
            hx-trigger="change">
          <span class="switchTrack"></span>
          <span class="switchDot"></span>
        </span>
      </label>
    </div>

    <div class="contact-grid">
      <div>
        <label>Etiqueta</label>
        <input class="input" name="contact_label[]"
               placeholder="Etiqueta"
               hx-post="{% url 'vcards:preview' %}"
               hx-trigger="keyup changed delay:250ms"
               hx-target="#preview" hx-include="#editorForm">
      </div>
      <div>
        <label>N√∫mero</label>
        <input class="input" name="contact_value[]"
               placeholder="+52 55 1234 5678"
               hx-post="{% url 'vcards:preview' %}"
               hx-trigger="keyup changed delay:250ms"
               hx-target="#preview" hx-include="#editorForm">
      </div>
    </div>
    <input type="hidden" name="contact_type[]" value="number">
  </div>
</template>

<template id="tpl-contact-address">
  <div class="contact-item" data-type="address">
    <div class="badge-del" title="Eliminar" data-del>üóëÔ∏è</div>

    <div class="fieldRow" style="margin-top:0">
      <div class="left">
        <div class="contact-title">Direcci√≥n</div>
        {% if globals.contact_address %}<span class="pillGlobal">Global</span>{% endif %}
      </div>
      <label class="switchLabel">
        <span>Usar en todas mis tarjetas</span>
        <span class="switch">
          <input
            type="checkbox"
            {% if globals.contact_address %}checked{% endif %}
            hx-post="{% url 'vcards:set_global' %}"
            hx-vals='js:{"field":"contact_address","enabled":this.checked}'
            hx-trigger="change">
          <span class="switchTrack"></span>
          <span class="switchDot"></span>
        </span>
      </label>
    </div>

    <div class="contact-grid">
      <div>
        <label>Etiqueta</label>
        <input class="input" name="contact_label[]"
               placeholder="Oficina / Sucursal"
               hx-post="{% url 'vcards:preview' %}"
               hx-trigger="keyup changed delay:250ms"
               hx-target="#preview" hx-include="#editorForm">
      </div>
      <div>
        <label>Direcci√≥n</label>
        <input class="input" name="contact_value[]"
               placeholder="Calle 123, Ciudad, Estado"
               hx-post="{% url 'vcards:preview' %}"
               hx-trigger="keyup changed delay:250ms"
               hx-target="#preview" hx-include="#editorForm">
      </div>
    </div>
    <input type="hidden" name="contact_type[]" value="address">
  </div>
</template>

{% endblock %}

{# JS propio de esta p√°gina #}
{% block scripts %}
<script src="{% static 'dashboard/js/user_vcard_create.js' %}"></script>
{% endblock %}